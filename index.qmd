---
title: "Multiple Sclerosis Age-Sex Specific Incidence Rates"
execute:
  echo: false
---

```{r}
#| label: setup
#| message: false
library(tidyverse)
library(plotly)
library(wesanderson)
```

```{r}
#| label: import data
ms_data <- read_csv("data/DataFilterExport.csv", show_col_types = FALSE) 
ms_data_clean <- ms_data |>
  filter(Year == "2022") 
```

```{r}
#| label: create plot
ms_bar <- 
  ms_data_clean |> 
  drop_na() |>
  ggplot(aes(x = Age, y = `Incidence Rate`, fill = Sex)) +
  geom_bar(stat = "identity", position = "dodge", width = 0.7) +
  geom_errorbar(aes(ymin = `Incidence Rate` - `Standard Error`,
                    ymax = `Incidence Rate` + `Standard Error`),
                position = position_dodge(width = 0.7), 
                width = 0.25,  
                alpha = 0.75) +
  scale_fill_manual(values = wes_palette("AsteroidCity1")) +
  labs(x = "Age Group", y = "Incidence Rate (per 100 000)", 
       title = "Age-Sex Specific Incidence Rates in Alberta, 2022", 
       fill = "Sex") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))  

interactive_bar <- 
  ggplotly(ms_bar, tooltip = c("Age", "Incidence Rate")) |>
    layout( annotations = list(
      text = "Data from Alberta IHDA",
      x = 1, y = -0.25,
      xref = "paper", yref = "paper",
      showarrow = FALSE,
      font = list(size = 12)), 
      margin = list(b = 100))

interactive_bar
```



Multiple Sclerosis (MS) is a devastating, demyelinating disease of the central nervous system that affects people of all ages and genders. MS Incidence Rate data, which is the number of incident (new) cases divided by the total population at risk per 100 000 people, was sourced from the government of Alberta's Interactive Health Data Application. The most recent data, from 2022, was isolated, and the resulting data frame was graphed. The resulting graphical analysis found that Multiple Sclerosis tends to affect women more often than men, and in Alberta, new cases are found most commonly among 35 to 39 year olds.   




